# -*- coding: utf-8 -*-
"""
ARIMA模型专用配置文件
包含ARIMA/SARIMA模型的所有配置参数
"""

# ==================== ARIMA模型训练配置 ====================
ARIMA_TRAINING_CONFIG = {
    "数据处理": {
        "启用数据处理": True,       # 是否启用数据处理
        "处理模式": "auto",         # 处理模式: auto(自动), manual(手动), skip(跳过)
        "使用处理后数据": True,     # 是否使用处理后的数据
        "数据质量要求": {
            "最小完整度": 0.9,      # 最小数据完整度
            "最大缺失值比例": 0.1,   # 最大缺失值比例
            "异常值处理": "clip"    # 异常值处理方式
        }
    },
    "训练时间范围": {
        "开始日期": "2014-03-01",  # 训练数据开始日期
        "结束日期": "2014-08-31",  # 训练数据结束日期
        "时间格式": "%Y-%m-%d",    # 日期格式
        "自动检测": False,         # 是否自动检测数据时间范围
        "最小训练天数": 30,        # 最小训练数据天数
        "最大训练天数": 365        # 最大训练数据天数
    },
    "数据极限": {
        "最小数据量": 100,         # 最小数据条数
        "最大数据量": 10000,       # 最大数据条数
        "数据采样": {
            "启用采样": False,     # 是否启用数据采样
            "采样比例": 0.8,       # 采样比例 (0-1)
            "采样方式": "random"   # 采样方式: random, systematic
        },
        "数据质量": {
            "最小完整度": 0.8,     # 最小数据完整度 (0-1)
            "最大缺失值比例": 0.2,  # 最大缺失值比例 (0-1)
            "异常值处理": "remove"  # 异常值处理方式: remove, clip, fill
        }
    },
    "模型参数": {
        "差分阶数": {
            "自动检测": True,      # 是否自动检测差分阶数
            "最大差分": 2,         # 最大差分阶数
            "季节性差分": True     # 是否进行季节性差分
        },
        "ARIMA参数": {
            # 收紧搜索范围，优先小范围快速收敛
            # 扩大搜索范围（首次搜索慢，后续走缓存）
            "p_range": [2, 3, 4, 5, 6, 7, 8, 9],   # AR阶数范围
            "d_range": [0, 1, 2],                 # 差分阶数范围
            "q_range": [2, 3, 4, 5, 6, 7, 8, 9],   # MA阶数范围
            "季节性参数": {
                "P_range": [0, 1, 2, 3],   # 季节性AR阶数范围
                "D_range": [0, 1],        # 季节性差分阶数范围
                "Q_range": [0, 1, 2, 3],   # 季节性MA阶数范围
                "候选周期": [7, 14, 28]    # 候选季节性周期（天）
            }
        },
        "模型选择": {
            "信息准则": "AIC",     # 信息准则: AIC, BIC, HQIC
            "交叉验证": {
                "启用": True,      # 是否启用交叉验证
                "折数": 5,         # 交叉验证折数
                "时间序列分割": True  # 是否使用时间序列分割
            }
        }
    },
    "预测配置": {
        "预测步数": 120,            # 预测未来天数
        "置信区间": 0.95,          # 置信区间水平
        "预测频率": "D",           # 预测频率: D(日), W(周), M(月)
        "噪声比例": 0.1,           # 净资金流预测噪声比例
        "申购噪声比例": 0.15,      # 申购金额预测噪声比例
        "赎回噪声比例": 0.15,      # 赎回金额预测噪声比例
        "输出格式": {
            "包含置信区间": True,   # 是否包含置信区间
            "包含历史数据": True,   # 是否包含历史数据
            "格式化输出": True      # 是否格式化输出
        }
    },
    "性能评估": {
        "评估指标": ["MAE", "MSE", "RMSE", "MAPE"],  # 评估指标列表
        "基准模型": "naive",       # 基准模型: naive, seasonal_naive, drift
        "模型比较": {
            "启用": True,          # 是否启用模型比较
            "比较模型": ["ARIMA", "SARIMA", "Prophet"],  # 比较的模型列表
            "可视化": True         # 是否生成比较可视化
        }
    }
}

# ==================== ARIMA输出配置 ====================
ARIMA_OUTPUT_CONFIG = {
    "图片保存路径": "output/arima",  # ARIMA相关图片保存路径
    "数据输出路径": "output/arima",  # ARIMA相关数据输出路径
    "图片格式": "png",              # 图片保存格式
    "图片DPI": 300,                 # 图片分辨率
    "数据格式": "csv"               # 数据输出格式
}

# ==================== ARIMA周期性检测配置 ====================
ARIMA_SEASONALITY_CONFIG = {
    "启用周期性检测": True,         # 是否启用周期性检测
    "检测方法": ["autocorr", "seasonal_decompose"],  # 检测方法列表
    "检测周期": [7, 14, 30, 90, 365],  # 检测的周期列表（天）
    "季节性强度阈值": 0.3,         # 季节性强度阈值，超过此值使用SARIMA
    "自相关分析": {
        "最大滞后": 50,            # 最大滞后阶数
        "最小滞后": 1,             # 最小滞后阶数
        "显著性水平": 0.05         # 显著性水平
    },
    "季节性分解": {
        "模型": "additive",        # 分解模型: additive, multiplicative
        "填充缺失值": True,        # 是否填充缺失值
        "外推": True              # 是否外推
    }
}

# ==================== ARIMA模型优化配置 ====================
ARIMA_OPTIMIZATION_CONFIG = {
    "启用参数优化": True,          # 是否启用参数优化
    "优化方法": "grid_search",     # 优化方法: grid_search, bayesian, genetic
    "搜索策略": {
        "最大组合数": 80,          # 首次更充分搜索，配合缓存
        "智能收缩": True,          # 使用自相关结果收缩范围
        "参数收缩比例": 0.4        # 略放宽
    },
    "早停策略": {
        "启用早停": True,          # 是否启用早停
        "最小改进": 0.01,          # 最小改进阈值
        "最大无改进次数": 10       # 放宽早停
    },
    # 参数缓存配置
    "参数缓存": {
        "启用": True,              # 是否启用参数缓存
        "路径": "cache/arima_param_cache.json"  # 参数缓存文件路径
    }
}

# ==================== ARIMA可视化配置 ====================
ARIMA_VISUALIZATION_CONFIG = {
    "启用可视化": True,            # 是否启用可视化
    "图表类型": {
        "时间序列图": True,        # 时间序列图
        "预测对比图": True,        # 预测对比图
        "残差分析图": True,        # 残差分析图
        "自相关图": True,          # 自相关图
        "季节性分解图": True       # 季节性分解图
    },
    "图表样式": {
        "主题": "default",         # 图表主题
        "颜色方案": "viridis",     # 颜色方案
        "字体大小": 12,            # 字体大小
        "图表尺寸": [15, 10]       # 图表尺寸 [宽度, 高度]
    },
    "保存设置": {
        "自动保存": True,          # 是否自动保存
        "保存格式": ["png", "pdf"], # 保存格式列表
        "保存路径": "output/arima" # 保存路径
    }
}

# ==================== ARIMA数据预处理配置 ====================
ARIMA_DATA_PREPROCESSING_CONFIG = {
    "时间字段": "report_date",     # 时间字段名
    "目标字段": {
        "净资金流": "Net_Flow",    # 净资金流字段
        "申购金额": "total_purchase_amt",  # 申购金额字段
        "赎回金额": "total_redeem_amt"     # 赎回金额字段
    },
    "数据清洗": {
        "处理缺失值": True,        # 是否处理缺失值
        "处理异常值": True,        # 是否处理异常值
        "时间对齐": True,          # 是否进行时间对齐
        "数据标准化": False        # 是否进行数据标准化
    },
    "特征工程": {
        "时间特征": True,          # 是否提取时间特征
        "滞后特征": False,         # 是否创建滞后特征
        "滚动统计": False          # 是否计算滚动统计
    }
}
